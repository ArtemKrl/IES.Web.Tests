
# add to pipeline variable $(PAT_TFS) = token for vitacoredo
#                         
name: git_sync_$(Date:yyyyMMdd)$(Rev:.r)
pr: none
trigger: 
#- ci
- '*'

variables:
  github_url: https://$(PAT_TFS)@github.com/vitacore-company/ies-tests.git
  git_url: ssh://tfs:22/tfs/IES.Web.Tests/_git/IES.Web.Tests
  git_dir: IES.Web.Tests

jobs:
- job: GitSyncToGithubCom
  pool:
    name: git-sync
  workspace: 
    clean: all
  steps:
  - task: InstallSSHKey@0
    inputs:
      knownHostsEntry: 'tfs'
      sshPublicKey: '$(ssh-TFS-GitHub)'
      sshKeySecureFile: 'ssh-TFS-GitHub'
    displayName: 'Install an SSH key'

  - script: ssh-keyscan -t rsa tfs >> ~/.ssh/known_hosts
    displayName: Install key

  - checkout: self

  - task: nkdAgility.gittasks.gitsync-task.gitsync@1
    displayName: 'Git Publish to https://github.com/vitacore-company/..'
    inputs:
      GitRepoUrl: '$(GIT_URL) '
    enabled: false

  